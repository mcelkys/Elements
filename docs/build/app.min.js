// Elements 1.4.0-alpha - Copyright (c) 2018 Mindaugas Celkys. Released under the MIT License.
!function(e,i,n){"use strict";var o="div",a="tag",c="function",r=function(){var n=!1;try{i.createElement(o).addEventListener("click",function(){},Object.defineProperty({},"passive",{get:function(){n=!0}}))}catch(e){n=!1}return!!n&&{passive:!0}}();function t(e,n){for(var t in n)e.setAttribute(t,n[t])}function d(e,n){for(var t in n)e.addEventListener(t,n[t],r)}var f={afterNode:function(e,n){var t=n.nextSibling;t?t.parentNode.insertBefore(e,t):n.parentNode.appendChild(e)},appendTo:function(e,n){n.appendChild(e)},atts:t,attributes:t,beforeNode:function(e,n){n.parentNode.insertBefore(e,n)},child:function(e,n){e.appendChild(l(n))},children:function(e,n){for(var t=n.length,r=0;r<t;r++)e.appendChild(l(n[r]))},class:function(e,n){var t=("string"==typeof n?n:String(n)).split(" "),r=e.classList;r.add.apply(r,t)},html:function(e,n){e.innerHTML=n},listeners:d,node:function(e,n){e.appendChild(n)},nodes:function(e,n){for(var t=n.length,r=0;r<t;r++)e.appendChild(n[r])},on:d,prependTo:function(e,n){var t=n.firstChild;t?n.insertBefore(e,t):n.appendChild(e)},replaceNode:function(e,n){n.parentNode.replaceChild(e,n)},set:function(e,n){for(var t in n)e[t]=n[t]},style:function(e,n){var t=e.style;for(var r in n)t.setProperty(r,n[r])},text:function(e,n){e.textContent=n}};function l(e){var n=i.createElement(a in e?e.tag:o);for(var t in e)if(t in f)f[t](n,e[t]);else{var r=Object.getOwnPropertyDescriptor(n.constructor.prototype,t);r&&typeof r.set===c?r.set.call(n,e[t]):t!==a&&n.setAttribute(t,e[t])}return n}Object.defineProperty(e,"Elements",{writable:!1,configurable:!1,enumerable:!1,value:Object.freeze({build:l,buildFragment:function(e){for(var n=i.createDocumentFragment(),t=e.length,r=0;r<t;r++)n.appendChild(l(e[r]));return n},defineProcessor:function(e,n){f[e]=n},removeAllChildren:function(e){for(var n=e.childNodes,t=n.length-1;0<=t;t--)e.removeChild(n[t])}})})}(window,document);
const Events=function(){const a=new EventTarget;return{generate(b,c){return new CustomEvent(b,{detail:c})},dispatch(b,c){const d=this.generate(b,c);this.propagate(d)},propagate(b){setTimeout(a.dispatchEvent.bind(a,b),0)},when(b,c){a.addEventListener(b,c,{passive:!0,capture:!1})},once(b,c){a.addEventListener(b,c,{passive:!0,capture:!1,once:!0})},remove(b,c){a.removeEventListener(b,c,!1)}}}(),Templates=function(){const a=new Map,b=new Map;return{withoutKey(c,d){InstanceManager.forUnbound(c),a.set(c,d)},withUniqueKey(c,d){InstanceManager.forStrictlyBound(c),a.set(c,d)},withCommonKey(c,d){InstanceManager.forLooselyBound(c),a.set(c,d)},render(c,d){const f=InstanceManager.get(c),g=b.get(c),h=a.get(c);return InstanceManager.scheduleGarbageCollection(),h(d,f.register.bind(f),g)},controllerFor(c,d){const f=InstanceManager.get(c),g=d(f);b.set(c,g)}}}(),InstanceManager=function(){function a(){const f=document.body;for(let g of c.keys())f.contains(g)||(c.get(g)(),c.delete(g))}const b=new Map,c=new Map;var d;return{get:b.get.bind(b),forUnbound(f){var g;const h=Object.freeze({register(i,j){g=j,c.set(i,h.clean.bind(h,j))},get:()=>g,has:()=>!!g,all:()=>[g],clean(i){g===i&&(g=null)}});b.set(f,h)},forStrictlyBound(f){const g=new Map,h=Object.freeze({register(i,j,k){g.set(j,k);c.set(i,h.clean.bind(h,j,k))},get:g.get.bind(g),has:g.has.bind(g),all:()=>Array.from(g.values()),clean(i,j){const k=g.get(i);k===j&&g.delete(i)}});b.set(f,h)},forLooselyBound(f){const g=new Map,h=Object.freeze({register(i,j,k){let l=g.get(j);l||(l=[],g.set(j,l)),l.push(k),c.set(i,h.clean.bind(h,j,k))},get:g.get.bind(g),has:g.has.bind(g),all:()=>Array.from(g.values()).reduce((i,j)=>i.concat(j),[]),clean(i,j){const k=g.get(i);if(k){const l=k.indexOf(j);0<=l&&k.splice(l,1),0===k.length&&g.delete(i)}}});b.set(f,h)},scheduleGarbageCollection(){clearTimeout(d),d=setTimeout(a,3e3)}}}(),Routes=function(){function a(){try{return JSON.parse(atob('#'===location.hash[0]?location.hash.slice(1):location.hash))}catch(d){return null}}function b(){return'#'+btoa(JSON.stringify(c))}var c=a();return c||(c={template:'home'},location.hash=b()),window.addEventListener('hashchange',function(){var d=b();if(d!==location.hash){var f=a();f&&Events.dispatch('routing',f)}},{passive:!0}),Events.when('routing',d=>{c=d.detail;var f=b();f!==location.hash&&(location.hash=f)}),{get:()=>c}}(),Articles=function(){function a(j,k){j.forEach((l,m)=>{const n=Uint32Array.of(...k,m);l.key=n.join(':'),l.retrieved=!1,f.set(l.key,l),g.set(l.title,l),l.src&&(i+=2e3,setTimeout(c.bind(this,l),i)),l.children instanceof Array&&a(l.children,n)})}function b(j){try{return new RegExp(j,'gi')}catch(k){return /(?:)/}}function c(j){j&&!j.retrieved&&'string'==typeof j.src&&Elements.build({tag:'script',atts:{type:'application/javascript',src:j.src},set:{async:!0,defer:!0},appendTo:document.head})}var d=[];const f=new Map,g=new Map;var h={},i=0;return{macros(j){Object.assign(h,j)},declare(j){d=j,a(j,new Uint32Array)},define(j,k){const l=g.get(j);l&&(l.retrieved=!0,l.render=k(Object.assign({},h)),Events.dispatch('article-updated',l.key))},all(){return d},get(j){const k=f.get(j);return c(k),k},search(j){const k=b(j);return Array.from(g.values()).filter(l=>k.test(l.title))}}}();Templates.withoutKey('layout',(a,b,c)=>{const d=document.createDocumentFragment(),f=Templates.render('toolbar');d.appendChild(f);const g=Elements.build({id:'content-wrapper',nodes:[Templates.render('sidebar'),Templates.render('main')],appendTo:d}),h=Elements.build({id:'overlay',class:'invisible hidden',on:{click:c.onOverlayClick.bind(c)},appendTo:d});return b(g,{overlay:h}),d}),Templates.withoutKey('toolbar',(a,b,c)=>{const d=Elements.build({tag:'input',atts:{type:'text',placeholder:'Search...'},on:{focus:c.onSearchInputFocus.bind(c),blur:c.onSearchInputBlur.bind(c),keyup:c.onSearchInputKeyUp.bind(c)}}),f=Elements.build({id:'search',nodes:[Elements.build({class:'icon'}),d]}),g=Elements.build({tag:'nav',id:'toolbar',children:[{tag:'button',class:'icon',on:{click:c.onMenuButtonClick.bind(c)}},{tag:'h1',on:{click:c.onTitleClick.bind(c)},children:[{tag:'span',text:'Elements'},{tag:'span',id:'version',text:'1.3.1'}]},{id:'search-wrapper',node:f},{id:'external-links',children:[{tag:'a',class:'icon',id:'github-button',href:'https://github.com/mcelkys/Elements'}]}]});return b(g,{search:f,searchInput:d}),g}),Templates.withoutKey('sidebar',(a,b,c)=>{const d=Elements.build({tag:'ul'}),f=Elements.build({tag:'aside',node:d});return b(f,{menu:d,node:f}),c.onRender(),f}),Templates.withUniqueKey('menu-item',({data:a,state:b},c,d)=>{const f=Elements.build({tag:'li',atts:{class:'article'===b.template?`${b.params.key.startsWith(a.key)?'open':''} ${b.params.key===a.key?'active':''}`:''},children:[{tag:'button',text:a.title,on:{click:d.onButtonClick.bind(d,a.key)}}].concat(a.children instanceof Array?[{tag:'ul',nodes:a.children.map(g=>Templates.render('menu-item',{data:g,state:b}))}]:[])});return c(f,a.key,{node:f,key:a.key}),f}),Templates.withoutKey('main',(a,b,c)=>{const d=Elements.build({tag:'main'});return b(d,{node:d,cache:new Map}),c.onRender(),d}),Templates.withoutKey('home',(a,b)=>{const d=Elements.build({id:'home',child:{id:'home-container',children:[{tag:'h2',text:'Elements'},{tag:'p',text:'A 2KB library for fast DOM building without frameworks.'},{tag:'a',text:'DOWNLOAD',atts:{href:'elements.min.js',download:'elements.min.js'}}]}});return b(d,d),d}),Templates.withoutKey('search-results',({query:a},b,c)=>{const d=Elements.build({tag:'ul'}),f=Elements.build({id:'search-results',nodes:[Elements.build({tag:'h2',text:`Results for /${a}/gi`}),d]});return b(f,{list:d}),c.onRender(a),f}),Templates.withUniqueKey('search-result',(a,b,c)=>{const d=Elements.build({tag:'li',text:a.title,on:{click:c.onClick.bind(c,a.key)}});return d}),Templates.withUniqueKey('article',({key:a},b,c)=>{const d=Elements.build({tag:'article'});return b(d,a,d),c.onRender(a),d}),Templates.controllerFor('layout',a=>{return window.addEventListener('load',()=>{const c=Templates.render('layout');document.body.appendChild(c)},{once:!0,passive:!0}),Events.when('opening-sidebar',()=>{const c=a.get();c&&(clearTimeout(c.timeoutId),c.overlay.classList.remove('hidden'),c.timeoutId=setTimeout(()=>{c.overlay.classList.remove('invisible')},100))}),Events.when('closing-sidebar',()=>{const c=a.get();c&&(clearTimeout(c.timeoutId),c.overlay.classList.add('invisible'),c.timeoutId=setTimeout(()=>{c.overlay.classList.add('hidden')},400))}),{onOverlayClick(b){const c=a.get();c&&c.overlay===b.target&&Events.dispatch('closing-sidebar')}}}),Templates.controllerFor('toolbar',a=>{return{onTitleClick(){Events.dispatch('routing',{template:'home'})},onSearchInputFocus(){const b=a.get();b&&b.search.classList.add('focused')},onSearchInputBlur(){const b=a.get();b&&(b.search.classList.remove('focused'),b.searchInput.value='')},onSearchInputKeyUp(){const b=a.get();b&&Events.dispatch('routing',{template:'search-results',params:{query:b.searchInput.value.trim()}})},onMenuButtonClick(){Events.dispatch('opening-sidebar')}}}),Templates.controllerFor('sidebar',a=>{return Events.when('opening-sidebar',()=>{const c=a.get();c&&c.node.classList.add('open')}),Events.when('closing-sidebar',()=>{const c=a.get();c&&c.node.classList.remove('open')}),{onRender(){const b=Articles.all(),c=a.get(),d=Routes.get();if(c&&b instanceof Array){const f=document.createDocumentFragment();for(let g of b){let h=Templates.render('menu-item',{data:g,state:d});f.appendChild(h)}c.menu.appendChild(f)}}}}),Templates.controllerFor('menu-item',a=>{return Events.when('routing',b=>{const{template:c,params:d}=b.detail;if('article'===c)for(let f of a.all())f.key===d.key?f.node.classList.add('active'):f.node.classList.remove('active'),d.key.startsWith(f.key)?f.node.classList.add('open'):f.node.classList.remove('open');else for(let f of a.all())f.node.classList.remove('active','open')}),{onButtonClick(b){Events.dispatch('routing',{template:'article',params:{key:b}}),Events.dispatch('closing-sidebar')}}}),Templates.controllerFor('main',a=>{function b(d,f){return btoa(JSON.stringify({template:d,params:f}))}function c({template:d,params:f}){const g=a.get(),h=b(d,f);g&&(g.content&&g.node.removeChild(g.content),g.cache.has(h)?g.content=g.cache.get(h):(g.content=Templates.render(d,f),g.cache.set(h,g.content)),g.node.appendChild(g.content))}return Events.when('routing',d=>c(d.detail)),{onRender(){c(Routes.get())}}}),Templates.controllerFor('search-results',a=>{return{onRender(b){const c=a.get();if(c){const d=Articles.search(b);Elements.removeAllChildren(c.list);const f=document.createDocumentFragment();for(let g of d){let h=Templates.render('search-result',g);f.appendChild(h)}c.list.appendChild(f)}}}}),Templates.controllerFor('search-result',()=>({onClick(b){Events.dispatch('routing',{template:'article',params:{key:b}})}})),Templates.controllerFor('article',a=>{const b={onRender(c){const d=a.get(c),f=Articles.get(c);if(d&&f&&(Elements.removeAllChildren(d),Elements.build({tag:'h2',text:f.title,appendTo:d}),f.render))if(f.render instanceof Array){const g=Elements.buildFragment(f.render);d.appendChild(g)}else{const g=Elements.build(f.render);d.appendChild(g)}}};return Events.when('article-updated',c=>b.onRender(c.detail)),b});
